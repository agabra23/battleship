(()=>{"use strict";const t=function(t){let e=0;const r=()=>{let e=0;return t.forEach((t=>{e++})),e};return{getLength:r,isSunk:()=>e>=r(),hit:()=>{e++},getHits:()=>e,getPath:()=>t,resetHits:()=>{e=0},hits:e}},e=e=>{const r=[],a=function(e){const r=[...Array(10)].map((t=>Array(10).fill("none"))),a=[],o=[];let n=[];const s=t=>{t.getPath().forEach((e=>{const[a,o]=e;r[a][o]=t})),c(t)},c=t=>{n.push(t)};return{placeShip:s,boardArray:r,receiveAttack:t=>{const[e,n]=t;let s,c=!1;s=a.some((e=>{const[r,a]=e;return r===t[0]&&a===t[1]})),c=o.some((e=>{const[r,a]=e;return r===t[0]&&a===t[1]})),"none"!==r[e][n]&&!1===s?(r[e][n].hit(),a.push(t)):"none"===r[e][n]&&!1===c&&o.push(t)},hits:a,misses:o,addShip:c,resetGameboard:()=>{a=[],o=[],n=[]},initBoard:()=>{s(t([[1,4],[1,5]])),s(t([[6,4],[6,5],[6,6]])),s(t([[4,2],[5,2],[6,2],[7,2]])),s(t([[8,3],[8,4],[8,5],[8,6],[8,7]])),s(t([[2,3],[2,4],[2,5],[2,6],[2,7]]))},isShip:t=>{const[e,a]=t;return"none"!==r[e][a]},getShip:t=>{const[e,a]=t;return r[e][a]},ships:n}}(),o=t=>{r.push(t)};return"computer"===e?{attempt:o,generateMove:()=>{const t=t=>Math.floor(Math.random()*t),e=t=>r.some((e=>{const[r,a]=e;return r===t[0]&&a===t[1]}));let a=[t(9),t(9)];for(;e(a);)a=[t(9),t(9)];return a},board:a}:{attempt:o,board:a}},r=t=>{const e=document.getElementById("board");t.boardArray.forEach(((r,a)=>{const o=document.createElement("div");o.classList.add("rowDiv"),r.forEach(((e,r)=>{const n=document.createElement("div");n.classList.add("boardCell"),n.id=`${a},${r}`,n.dataset.board=t.type,n.dataset.x=a,n.dataset.y=r,"none"!==e&&n.classList.add("shipCell"),o.appendChild(n)})),e.appendChild(o)}))},a=(t,e)=>{const[r,a]=t,o=document.getElementById(`${r},${a}`),n=e.isShip(t);o.innerHTML=n?"Hit":"Miss"},o=(()=>{const t=e("computer"),r=e("user");let n=r;const s=t=>{t.board.ships.every((t=>t.isSunk()))&&alert("win")};return{initGame:()=>{console.log("init");const e=r.board;t.board.initBoard(),e.initBoard()},playRound:(e,o)=>{e===r&&(t.board.receiveAttack([2,3]),a([2,3],t.board))},switchTurn:()=>{n=n===r?t:r},computerPlayer:t,userPlayer:r,currentPlayer:n,checkLoss:s,moveEvent:t=>{const e="computer"===t.dataset.board?o.computerPlayer.board:o.userPlayer.board;o.computerPlayer.board.receiveAttack([t.dataset.x,t.dataset.y]),a([t.dataset.x,t.dataset.y],e),s(o.computerPlayer)}}})(),n=o;n.initGame(),r(n.computerPlayer.board),n.playRound(n.currentPlayer),document.querySelectorAll(".boardCell").forEach((t=>{t.addEventListener("click",(()=>{n.moveEvent(t)}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwibWFwcGluZ3MiOiJtQkFBQSxNQWlDQSxFQWpDYSxTQUFVQSxHQUNyQixJQUFJQyxFQUFPLEVBRVgsTUFRTUMsRUFBWSxLQUNoQixJQUFJQyxFQUFRLEVBSVosT0FIQUgsRUFBS0ksU0FBU0MsSUFDWkYsR0FBTyxJQUVGQSxDQUFLLEVBZWQsTUFBTyxDQUFFRCxZQUFXSSxPQVpMLElBQ05MLEdBQVFDLElBV1dLLElBeEJoQixLQUNWTixHQUFNLEVBdUJ5Qk8sUUE1QmpCLElBQ1BQLEVBMkJpQ1EsUUFSMUIsSUFDUFQsRUFPMENVLFVBSmpDLEtBQ2hCVCxFQUFPLENBQUMsRUFHb0RBLE9BQ2hFLEVDUUEsRUF0Q2dCVSxJQUNkLE1BQU1DLEVBQVcsR0FFWEMsRUNIVSxTQUFVRixHQUMxQixNQUFNRyxFQUFhLElBQUlDLE1BQU0sS0FBS0MsS0FBS0MsR0FBTUYsTUFBTSxJQUFJRyxLQUFLLFVBQ3REakIsRUFBTyxHQUNQa0IsRUFBUyxHQUNmLElBQUlDLEVBQVEsR0FFWixNQWlETUMsRUFBYUMsSUFDSkEsRUFBV2IsVUFDbkJMLFNBQVNtQixJQUNaLE1BQU9DLEVBQUdDLEdBQUtGLEVBQ2ZULEVBQVdVLEdBQUdDLEdBQUtILENBQVUsSUFFL0JJLEVBQVFKLEVBQVcsRUEwQmZJLEVBQVdDLElBQ2ZQLEVBQU1RLEtBQUtELEVBQUssRUFlbEIsTUFBTyxDQUNMTixZQUNBUCxhQUNBZSxjQTFDcUJOLElBQ3JCLE1BQU9DLEVBQUdDLEdBQUtGLEVBRWYsSUFBSU8sRUFDRkMsR0FBYyxFQUVoQkQsRUFBYTdCLEVBQUsrQixNQUFNQyxJQUN0QixNQUFPQyxFQUFPQyxHQUFTRixFQUN2QixPQUFPQyxJQUFVWCxFQUFZLElBQU1ZLElBQVVaLEVBQVksRUFBRSxJQUU3RFEsRUFBY1osRUFBT2EsTUFBTUMsSUFDekIsTUFBT0MsRUFBT0MsR0FBU0YsRUFDdkIsT0FBT0MsSUFBVVgsRUFBWSxJQUFNWSxJQUFVWixFQUFZLEVBQUUsSUFHcEMsU0FBckJULEVBQVdVLEdBQUdDLEtBQWdDLElBQWZLLEdBQ2pDaEIsRUFBV1UsR0FBR0MsR0FBR2xCLE1BQ2pCTixFQUFLMkIsS0FBS0wsSUFDb0IsU0FBckJULEVBQVdVLEdBQUdDLEtBQWlDLElBQWhCTSxHQUN4Q1osRUFBT1MsS0FBS0wsRUFDZCxFQXVCQXRCLE9BQ0FrQixTQUNBTyxVQUNBVSxlQTdEcUIsS0FDckJuQyxFQUFPLEdBQ1BrQixFQUFTLEdBQ1RDLEVBQVEsRUFBRSxFQTJEVmlCLFVBekdnQixLQUNoQmhCLEVBQ0UsRUFBSyxDQUNILENBQUMsRUFBRyxHQUNKLENBQUMsRUFBRyxNQUdSQSxFQUNFLEVBQUssQ0FDSCxDQUFDLEVBQUcsR0FDSixDQUFDLEVBQUcsR0FDSixDQUFDLEVBQUcsTUFHUkEsRUFDRSxFQUFLLENBQ0gsQ0FBQyxFQUFHLEdBQ0osQ0FBQyxFQUFHLEdBQ0osQ0FBQyxFQUFHLEdBQ0osQ0FBQyxFQUFHLE1BSVJBLEVBQ0UsRUFBSyxDQUNILENBQUMsRUFBRyxHQUNKLENBQUMsRUFBRyxHQUNKLENBQUMsRUFBRyxHQUNKLENBQUMsRUFBRyxHQUNKLENBQUMsRUFBRyxNQUdSQSxFQUNFLEVBQUssQ0FDSCxDQUFDLEVBQUcsR0FDSixDQUFDLEVBQUcsR0FDSixDQUFDLEVBQUcsR0FDSixDQUFDLEVBQUcsR0FDSixDQUFDLEVBQUcsS0FFUCxFQWtFRGlCLE9BckJjZixJQUNkLE1BQU9DLEVBQUdDLEdBQUtGLEVBRWYsTUFBNEIsU0FBckJULEVBQVdVLEdBQUdDLEVBQWEsRUFtQmxDYyxRQWhCZWhCLElBQ2YsTUFBT0MsRUFBR0MsR0FBS0YsRUFFZixPQUFPVCxFQUFXVSxHQUFHQyxFQUFFLEVBY3ZCTCxRQUVKLENEakhnQixHQUVSb0IsRUFBV2pCLElBQ2ZYLEVBQVNnQixLQUFLTCxFQUFZLEVBMkI1QixNQUFhLGFBQVRaLEVBQTRCLENBQUU2QixVQUFTQyxhQXhCdEIsS0FDbkIsTUFBTUMsRUFBZ0JDLEdBQ2JDLEtBQUtDLE1BQU1ELEtBQUtFLFNBQVdILEdBRzlCSSxFQUFrQlAsR0FDUDVCLEVBQVNvQixNQUFNZ0IsSUFDNUIsTUFBT3hCLEVBQUdDLEdBQUt1QixFQUVmLE9BQU94QixJQUFNZ0IsRUFBUSxJQUFNZixJQUFNZSxFQUFRLEVBQUUsSUFNL0MsSUFBSVMsRUFBTyxDQUFDUCxFQUFhLEdBQUlBLEVBQWEsSUFFMUMsS0FBT0ssRUFBZUUsSUFDcEJBLEVBQU8sQ0FBQ1AsRUFBYSxHQUFJQSxFQUFhLElBR3hDLE9BQU9PLENBQUksRUFHNENwQyxTQUVsRCxDQUFFMkIsVUFBUzNCLFFBQU8sRUVNM0IsRUF0Q3VCcUMsSUFDbkIsTUFBTXJDLEVBQVFzQyxTQUFTQyxlQUFlLFNBRXRDRixFQUFZcEMsV0FBV1YsU0FBUSxDQUFDaUQsRUFBS0MsS0FDbkMsTUFBTUMsRUFBU0osU0FBU0ssY0FBYyxPQUN0Q0QsRUFBT0UsVUFBVUMsSUFBSSxVQUVyQkwsRUFBSWpELFNBQVEsQ0FBQzZCLEVBQU0wQixLQUNqQixNQUFNQyxFQUFPVCxTQUFTSyxjQUFjLE9BQ3BDSSxFQUFLSCxVQUFVQyxJQUFJLGFBQ25CRSxFQUFLQyxHQUFLLEdBQUdQLEtBQVlLLElBQ3pCQyxFQUFLRSxRQUFRakQsTUFBUXFDLEVBQVl2QyxLQUNqQ2lELEVBQUtFLFFBQVF0QyxFQUFJOEIsRUFDakJNLEVBQUtFLFFBQVFyQyxFQUFJa0MsRUFDSixTQUFUMUIsR0FBaUIyQixFQUFLSCxVQUFVQyxJQUFJLFlBRXhDSCxFQUFPUSxZQUFZSCxFQUFLLElBRzFCL0MsRUFBTWtELFlBQVlSLEVBQU8sR0FDekIsRUFrQk4sRUFma0IsQ0FBQ2hDLEVBQWF5QyxLQUM1QixNQUFPeEMsRUFBR0MsR0FBS0YsRUFDVDBDLEVBQWFkLFNBQVNDLGVBQWUsR0FBRzVCLEtBQUtDLEtBQzdDYSxFQUFTMEIsRUFBVTFCLE9BQU9mLEdBRzlCMEMsRUFBV0MsVUFEVDVCLEVBQ3FCLE1BRUEsTUFDekIsRUNoQ0U2QixFQUFPLE1BQ1gsTUFBTUMsRUFBaUIsRUFBTyxZQUN4QkMsRUFBYSxFQUFPLFFBRTFCLElBQUlDLEVBQWdCRCxFQUVwQixNQXdCTUUsRUFBYUMsSUFDREEsRUFBTzNELE1BQU1PLE1BQU1xRCxPQUFPOUMsR0FDakNBLEVBQUtyQixZQUdEb0UsTUFBTSxNQUFNLEVBYzNCLE1BQU8sQ0FDTEMsU0E1Q2UsS0FDZkMsUUFBUUMsSUFBSSxRQUVaLE1BQU1DLEVBQVlULEVBQVd4RCxNQUNQdUQsRUFBZXZELE1BQ3ZCd0IsWUFDZHlDLEVBQVV6QyxXQUFXLEVBdUNyQjBDLFVBcENnQixDQUFDUCxFQUFRakQsS0FDckJpRCxJQUFXSCxJQUNiRCxFQUFldkQsTUFBTWdCLGNBQWMsQ0FBQyxFQUFHLElBQ3ZDLEVBQVcsQ0FBQyxFQUFHLEdBQUl1QyxFQUFldkQsT0FDcEMsRUFpQ0FtRSxXQTlCaUIsS0FFZlYsRUFERUEsSUFBa0JELEVBQ0pELEVBRUFDLENBQ2xCLEVBMEJBRCxpQkFDQUMsYUFDQUMsZ0JBQ0FDLFlBQ0FVLFVBbkJpQnJCLElBQ2pCLE1BQU1zQixFQUNtQixhQUF2QnRCLEVBQUtFLFFBQVFqRCxNQUNUc0QsRUFBS0MsZUFBZXZELE1BQ3BCc0QsRUFBS0UsV0FBV3hELE1BRXRCc0QsRUFBS0MsZUFBZXZELE1BQU1nQixjQUFjLENBQUMrQixFQUFLRSxRQUFRdEMsRUFBR29DLEVBQUtFLFFBQVFyQyxJQUN0RSxFQUFXLENBQUNtQyxFQUFLRSxRQUFRdEMsRUFBR29DLEVBQUtFLFFBQVFyQyxHQUFJeUQsR0FDN0NYLEVBQVVKLEVBQUtDLGVBQWUsRUFhakMsRUEzRFksR0E2RGIsSUM3REEsRUFBS08sV0FDTCxFQUFlLEVBQUtQLGVBQWV2RCxPQUVuQyxFQUFLa0UsVUFBVSxFQUFLVCxlQUVIbkIsU0FBU2dDLGlCQUFpQixjQUNsQy9FLFNBQVN3RCxJQUNoQkEsRUFBS3dCLGlCQUFpQixTQUFTLEtBQzdCLEVBQUtILFVBQVVyQixFQUFLLEdBQ3BCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvU2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvUGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9HYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL1VJLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9nYW1lLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU2hpcCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gIGxldCBoaXRzID0gMDtcblxuICBjb25zdCBnZXRIaXRzID0gKCkgPT4ge1xuICAgIHJldHVybiBoaXRzO1xuICB9O1xuXG4gIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICBoaXRzKys7XG4gIH07XG5cbiAgY29uc3QgZ2V0TGVuZ3RoID0gKCkgPT4ge1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgcGF0aC5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICBjb3VudCsrO1xuICAgIH0pO1xuICAgIHJldHVybiBjb3VudDtcbiAgfTtcblxuICBjb25zdCBpc1N1bmsgPSAoKSA9PiB7XG4gICAgcmV0dXJuIGhpdHMgPj0gZ2V0TGVuZ3RoKCk7XG4gIH07XG5cbiAgY29uc3QgZ2V0UGF0aCA9ICgpID0+IHtcbiAgICByZXR1cm4gcGF0aDtcbiAgfTtcblxuICBjb25zdCByZXNldEhpdHMgPSAoKSA9PiB7XG4gICAgaGl0cyA9IDA7XG4gIH07XG5cbiAgcmV0dXJuIHsgZ2V0TGVuZ3RoLCBpc1N1bmssIGhpdCwgZ2V0SGl0cywgZ2V0UGF0aCwgcmVzZXRIaXRzLCBoaXRzIH07XG59O1xuZXhwb3J0IGRlZmF1bHQgU2hpcDtcbiIsImltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vR2FtZWJvYXJkXCI7XG5cbmNvbnN0IFBsYXllciA9ICh0eXBlKSA9PiB7XG4gIGNvbnN0IGF0dGVtcHRzID0gW107XG4gIGNvbnN0IHR1cm4gPSBmYWxzZTtcbiAgY29uc3QgYm9hcmQgPSBHYW1lYm9hcmQodHlwZSk7XG5cbiAgY29uc3QgYXR0ZW1wdCA9IChjb29yZGluYXRlcykgPT4ge1xuICAgIGF0dGVtcHRzLnB1c2goY29vcmRpbmF0ZXMpO1xuICB9O1xuXG4gIGNvbnN0IGdlbmVyYXRlTW92ZSA9ICgpID0+IHtcbiAgICBjb25zdCBnZXRSYW5kb21JbnQgPSAobWF4KSA9PiB7XG4gICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWF4KTtcbiAgICB9O1xuXG4gICAgY29uc3QgY2hlY2tBdHRlbXB0ZWQgPSAoYXR0ZW1wdCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXR0ZW1wdHMuc29tZSgoY29vcmRpbmF0ZSkgPT4ge1xuICAgICAgICBjb25zdCBbeCwgeV0gPSBjb29yZGluYXRlO1xuXG4gICAgICAgIHJldHVybiB4ID09PSBhdHRlbXB0WzBdICYmIHkgPT09IGF0dGVtcHRbMV07XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgbGV0IG1vdmUgPSBbZ2V0UmFuZG9tSW50KDkpLCBnZXRSYW5kb21JbnQoOSldO1xuXG4gICAgd2hpbGUgKGNoZWNrQXR0ZW1wdGVkKG1vdmUpKSB7XG4gICAgICBtb3ZlID0gW2dldFJhbmRvbUludCg5KSwgZ2V0UmFuZG9tSW50KDkpXTtcbiAgICB9XG5cbiAgICByZXR1cm4gbW92ZTtcbiAgfTtcblxuICBpZiAodHlwZSA9PT0gXCJjb21wdXRlclwiKSByZXR1cm4geyBhdHRlbXB0LCBnZW5lcmF0ZU1vdmUsIGJvYXJkIH07XG5cbiAgcmV0dXJuIHsgYXR0ZW1wdCwgYm9hcmQgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFBsYXllcjtcbiIsImltcG9ydCBTaGlwIGZyb20gXCIuL1NoaXAuanNcIjtcblxuY29uc3QgR2FtZWJvYXJkID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgY29uc3QgYm9hcmRBcnJheSA9IFsuLi5BcnJheSgxMCldLm1hcCgoZSkgPT4gQXJyYXkoMTApLmZpbGwoXCJub25lXCIpKTtcbiAgY29uc3QgaGl0cyA9IFtdO1xuICBjb25zdCBtaXNzZXMgPSBbXTtcbiAgbGV0IHNoaXBzID0gW107XG5cbiAgY29uc3QgaW5pdEJvYXJkID0gKCkgPT4ge1xuICAgIHBsYWNlU2hpcChcbiAgICAgIFNoaXAoW1xuICAgICAgICBbMSwgNF0sXG4gICAgICAgIFsxLCA1XSxcbiAgICAgIF0pXG4gICAgKTtcbiAgICBwbGFjZVNoaXAoXG4gICAgICBTaGlwKFtcbiAgICAgICAgWzYsIDRdLFxuICAgICAgICBbNiwgNV0sXG4gICAgICAgIFs2LCA2XSxcbiAgICAgIF0pXG4gICAgKTtcbiAgICBwbGFjZVNoaXAoXG4gICAgICBTaGlwKFtcbiAgICAgICAgWzQsIDJdLFxuICAgICAgICBbNSwgMl0sXG4gICAgICAgIFs2LCAyXSxcbiAgICAgICAgWzcsIDJdLFxuICAgICAgXSlcbiAgICApO1xuXG4gICAgcGxhY2VTaGlwKFxuICAgICAgU2hpcChbXG4gICAgICAgIFs4LCAzXSxcbiAgICAgICAgWzgsIDRdLFxuICAgICAgICBbOCwgNV0sXG4gICAgICAgIFs4LCA2XSxcbiAgICAgICAgWzgsIDddLFxuICAgICAgXSlcbiAgICApO1xuICAgIHBsYWNlU2hpcChcbiAgICAgIFNoaXAoW1xuICAgICAgICBbMiwgM10sXG4gICAgICAgIFsyLCA0XSxcbiAgICAgICAgWzIsIDVdLFxuICAgICAgICBbMiwgNl0sXG4gICAgICAgIFsyLCA3XSxcbiAgICAgIF0pXG4gICAgKTtcbiAgfTtcblxuICBjb25zdCByZXNldEdhbWVib2FyZCA9ICgpID0+IHtcbiAgICBoaXRzID0gW107XG4gICAgbWlzc2VzID0gW107XG4gICAgc2hpcHMgPSBbXTtcbiAgfTtcblxuICBjb25zdCBwbGFjZVNoaXAgPSAoc2hpcE9iamVjdCkgPT4ge1xuICAgIGNvbnN0IHBhdGggPSBzaGlwT2JqZWN0LmdldFBhdGgoKTtcbiAgICBwYXRoLmZvckVhY2goKGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgICBjb25zdCBbeCwgeV0gPSBjb29yZGluYXRlcztcbiAgICAgIGJvYXJkQXJyYXlbeF1beV0gPSBzaGlwT2JqZWN0O1xuICAgIH0pO1xuICAgIGFkZFNoaXAoc2hpcE9iamVjdCk7XG4gIH07XG5cbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IChjb29yZGluYXRlcykgPT4ge1xuICAgIGNvbnN0IFt4LCB5XSA9IGNvb3JkaW5hdGVzO1xuXG4gICAgbGV0IGFscmVhZHlIaXQsXG4gICAgICBhbHJlYWR5TWlzcyA9IGZhbHNlO1xuXG4gICAgYWxyZWFkeUhpdCA9IGhpdHMuc29tZSgoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgW3hJdGVtLCB5SXRlbV0gPSBpdGVtO1xuICAgICAgcmV0dXJuIHhJdGVtID09PSBjb29yZGluYXRlc1swXSAmJiB5SXRlbSA9PT0gY29vcmRpbmF0ZXNbMV07XG4gICAgfSk7XG4gICAgYWxyZWFkeU1pc3MgPSBtaXNzZXMuc29tZSgoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgW3hJdGVtLCB5SXRlbV0gPSBpdGVtO1xuICAgICAgcmV0dXJuIHhJdGVtID09PSBjb29yZGluYXRlc1swXSAmJiB5SXRlbSA9PT0gY29vcmRpbmF0ZXNbMV07XG4gICAgfSk7XG5cbiAgICBpZiAoYm9hcmRBcnJheVt4XVt5XSAhPT0gXCJub25lXCIgJiYgYWxyZWFkeUhpdCA9PT0gZmFsc2UpIHtcbiAgICAgIGJvYXJkQXJyYXlbeF1beV0uaGl0KCk7XG4gICAgICBoaXRzLnB1c2goY29vcmRpbmF0ZXMpO1xuICAgIH0gZWxzZSBpZiAoYm9hcmRBcnJheVt4XVt5XSA9PT0gXCJub25lXCIgJiYgYWxyZWFkeU1pc3MgPT09IGZhbHNlKSB7XG4gICAgICBtaXNzZXMucHVzaChjb29yZGluYXRlcyk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGFkZFNoaXAgPSAoc2hpcCkgPT4ge1xuICAgIHNoaXBzLnB1c2goc2hpcCk7XG4gIH07XG5cbiAgY29uc3QgaXNTaGlwID0gKGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgY29uc3QgW3gsIHldID0gY29vcmRpbmF0ZXM7XG5cbiAgICByZXR1cm4gYm9hcmRBcnJheVt4XVt5XSAhPT0gXCJub25lXCI7XG4gIH07XG5cbiAgY29uc3QgZ2V0U2hpcCA9IChjb29yZGluYXRlcykgPT4ge1xuICAgIGNvbnN0IFt4LCB5XSA9IGNvb3JkaW5hdGVzO1xuXG4gICAgcmV0dXJuIGJvYXJkQXJyYXlbeF1beV07XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBwbGFjZVNoaXAsXG4gICAgYm9hcmRBcnJheSxcbiAgICByZWNlaXZlQXR0YWNrLFxuICAgIGhpdHMsXG4gICAgbWlzc2VzLFxuICAgIGFkZFNoaXAsXG4gICAgcmVzZXRHYW1lYm9hcmQsXG4gICAgaW5pdEJvYXJkLFxuICAgIGlzU2hpcCxcbiAgICBnZXRTaGlwLFxuICAgIHNoaXBzLFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgR2FtZWJvYXJkO1xuIiwiaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9HYW1lYm9hcmRcIjtcbmltcG9ydCBQbGF5ZXIgZnJvbSBcIi4vUGxheWVyXCI7XG5pbXBvcnQgU2hpcCBmcm9tIFwiLi9TaGlwXCI7XG5cbmNvbnN0IFVJID0gKCgpID0+IHtcbiAgY29uc3QgcmVuZGVyQm9hcmQgPSAocGxheWVyQm9hcmQpID0+IHtcbiAgICBjb25zdCBib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYm9hcmRcIik7XG5cbiAgICBwbGF5ZXJCb2FyZC5ib2FyZEFycmF5LmZvckVhY2goKHJvdywgcm93SW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IHJvd0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICByb3dEaXYuY2xhc3NMaXN0LmFkZChcInJvd0RpdlwiKTtcblxuICAgICAgcm93LmZvckVhY2goKGl0ZW0sIGNlbGxJbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBjZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKFwiYm9hcmRDZWxsXCIpO1xuICAgICAgICBjZWxsLmlkID0gYCR7cm93SW5kZXh9LCR7Y2VsbEluZGV4fWA7XG4gICAgICAgIGNlbGwuZGF0YXNldC5ib2FyZCA9IHBsYXllckJvYXJkLnR5cGU7XG4gICAgICAgIGNlbGwuZGF0YXNldC54ID0gcm93SW5kZXg7XG4gICAgICAgIGNlbGwuZGF0YXNldC55ID0gY2VsbEluZGV4O1xuICAgICAgICBpZiAoaXRlbSAhPT0gXCJub25lXCIpIGNlbGwuY2xhc3NMaXN0LmFkZChcInNoaXBDZWxsXCIpO1xuXG4gICAgICAgIHJvd0Rpdi5hcHBlbmRDaGlsZChjZWxsKTtcbiAgICAgIH0pO1xuXG4gICAgICBib2FyZC5hcHBlbmRDaGlsZChyb3dEaXYpO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGF0dGVtcHQgPSAoY29vcmRpbmF0ZXMsIGdhbWVib2FyZCkgPT4ge1xuICAgIGNvbnN0IFt4LCB5XSA9IGNvb3JkaW5hdGVzO1xuICAgIGNvbnN0IHRhcmdldENlbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt4fSwke3l9YCk7XG4gICAgY29uc3QgaXNTaGlwID0gZ2FtZWJvYXJkLmlzU2hpcChjb29yZGluYXRlcyk7XG5cbiAgICBpZiAoaXNTaGlwKSB7XG4gICAgICB0YXJnZXRDZWxsLmlubmVySFRNTCA9IFwiSGl0XCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhcmdldENlbGwuaW5uZXJIVE1MID0gXCJNaXNzXCI7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7IHJlbmRlckJvYXJkLCBhdHRlbXB0IH07XG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBVSTtcbiIsImltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vR2FtZWJvYXJkXCI7XG5pbXBvcnQgU2hpcCBmcm9tIFwiLi9TaGlwXCI7XG5pbXBvcnQgUGxheWVyIGZyb20gXCIuL1BsYXllclwiO1xuaW1wb3J0IFVJIGZyb20gXCIuL1VJXCI7XG5cbmNvbnN0IGdhbWUgPSAoKCkgPT4ge1xuICBjb25zdCBjb21wdXRlclBsYXllciA9IFBsYXllcihcImNvbXB1dGVyXCIpO1xuICBjb25zdCB1c2VyUGxheWVyID0gUGxheWVyKFwidXNlclwiKTtcblxuICBsZXQgY3VycmVudFBsYXllciA9IHVzZXJQbGF5ZXI7XG5cbiAgY29uc3QgaW5pdEdhbWUgPSAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJpbml0XCIpO1xuXG4gICAgY29uc3QgdXNlckJvYXJkID0gdXNlclBsYXllci5ib2FyZDtcbiAgICBjb25zdCBjb21wdXRlckJvYXJkID0gY29tcHV0ZXJQbGF5ZXIuYm9hcmQ7XG4gICAgY29tcHV0ZXJCb2FyZC5pbml0Qm9hcmQoKTtcbiAgICB1c2VyQm9hcmQuaW5pdEJvYXJkKCk7XG4gIH07XG5cbiAgY29uc3QgcGxheVJvdW5kID0gKHBsYXllciwgY29vcmRpbmF0ZXMpID0+IHtcbiAgICBpZiAocGxheWVyID09PSB1c2VyUGxheWVyKSB7XG4gICAgICBjb21wdXRlclBsYXllci5ib2FyZC5yZWNlaXZlQXR0YWNrKFsyLCAzXSk7XG4gICAgICBVSS5hdHRlbXB0KFsyLCAzXSwgY29tcHV0ZXJQbGF5ZXIuYm9hcmQpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBzd2l0Y2hUdXJuID0gKCkgPT4ge1xuICAgIGlmIChjdXJyZW50UGxheWVyID09PSB1c2VyUGxheWVyKSB7XG4gICAgICBjdXJyZW50UGxheWVyID0gY29tcHV0ZXJQbGF5ZXI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGN1cnJlbnRQbGF5ZXIgPSB1c2VyUGxheWVyO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBjaGVja0xvc3MgPSAocGxheWVyKSA9PiB7XG4gICAgY29uc3QgYWxsU3VuayA9IHBsYXllci5ib2FyZC5zaGlwcy5ldmVyeSgoc2hpcCkgPT4ge1xuICAgICAgcmV0dXJuIHNoaXAuaXNTdW5rKCk7XG4gICAgfSk7XG5cbiAgICBpZiAoYWxsU3VuaykgYWxlcnQoXCJ3aW5cIik7XG4gIH07XG5cbiAgY29uc3QgbW92ZUV2ZW50ID0gKGNlbGwpID0+IHtcbiAgICBjb25zdCBjZWxsQm9hcmQgPVxuICAgICAgY2VsbC5kYXRhc2V0LmJvYXJkID09PSBcImNvbXB1dGVyXCJcbiAgICAgICAgPyBnYW1lLmNvbXB1dGVyUGxheWVyLmJvYXJkXG4gICAgICAgIDogZ2FtZS51c2VyUGxheWVyLmJvYXJkO1xuXG4gICAgZ2FtZS5jb21wdXRlclBsYXllci5ib2FyZC5yZWNlaXZlQXR0YWNrKFtjZWxsLmRhdGFzZXQueCwgY2VsbC5kYXRhc2V0LnldKTtcbiAgICBVSS5hdHRlbXB0KFtjZWxsLmRhdGFzZXQueCwgY2VsbC5kYXRhc2V0LnldLCBjZWxsQm9hcmQpO1xuICAgIGNoZWNrTG9zcyhnYW1lLmNvbXB1dGVyUGxheWVyKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluaXRHYW1lLFxuICAgIHBsYXlSb3VuZCxcbiAgICBzd2l0Y2hUdXJuLFxuICAgIGNvbXB1dGVyUGxheWVyLFxuICAgIHVzZXJQbGF5ZXIsXG4gICAgY3VycmVudFBsYXllcixcbiAgICBjaGVja0xvc3MsXG4gICAgbW92ZUV2ZW50LFxuICB9O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgZ2FtZTtcbiIsImltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vbW9kdWxlcy9HYW1lYm9hcmQuanNcIjtcbmltcG9ydCBTaGlwIGZyb20gXCIuL21vZHVsZXMvU2hpcC5qc1wiO1xuaW1wb3J0IGdhbWUgZnJvbSBcIi4vbW9kdWxlcy9nYW1lLmpzXCI7XG5pbXBvcnQgVUkgZnJvbSBcIi4vbW9kdWxlcy9VSS5qc1wiO1xuXG5nYW1lLmluaXRHYW1lKCk7XG5VSS5yZW5kZXJCb2FyZChnYW1lLmNvbXB1dGVyUGxheWVyLmJvYXJkKTtcblxuZ2FtZS5wbGF5Um91bmQoZ2FtZS5jdXJyZW50UGxheWVyKTtcblxuY29uc3QgYWxsQ2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJvYXJkQ2VsbFwiKTtcbmFsbENlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgY2VsbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGdhbWUubW92ZUV2ZW50KGNlbGwpO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbInBhdGgiLCJoaXRzIiwiZ2V0TGVuZ3RoIiwiY291bnQiLCJmb3JFYWNoIiwiZWxlbWVudCIsImlzU3VuayIsImhpdCIsImdldEhpdHMiLCJnZXRQYXRoIiwicmVzZXRIaXRzIiwidHlwZSIsImF0dGVtcHRzIiwiYm9hcmQiLCJib2FyZEFycmF5IiwiQXJyYXkiLCJtYXAiLCJlIiwiZmlsbCIsIm1pc3NlcyIsInNoaXBzIiwicGxhY2VTaGlwIiwic2hpcE9iamVjdCIsImNvb3JkaW5hdGVzIiwieCIsInkiLCJhZGRTaGlwIiwic2hpcCIsInB1c2giLCJyZWNlaXZlQXR0YWNrIiwiYWxyZWFkeUhpdCIsImFscmVhZHlNaXNzIiwic29tZSIsIml0ZW0iLCJ4SXRlbSIsInlJdGVtIiwicmVzZXRHYW1lYm9hcmQiLCJpbml0Qm9hcmQiLCJpc1NoaXAiLCJnZXRTaGlwIiwiYXR0ZW1wdCIsImdlbmVyYXRlTW92ZSIsImdldFJhbmRvbUludCIsIm1heCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNoZWNrQXR0ZW1wdGVkIiwiY29vcmRpbmF0ZSIsIm1vdmUiLCJwbGF5ZXJCb2FyZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyb3ciLCJyb3dJbmRleCIsInJvd0RpdiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJjZWxsSW5kZXgiLCJjZWxsIiwiaWQiLCJkYXRhc2V0IiwiYXBwZW5kQ2hpbGQiLCJnYW1lYm9hcmQiLCJ0YXJnZXRDZWxsIiwiaW5uZXJIVE1MIiwiZ2FtZSIsImNvbXB1dGVyUGxheWVyIiwidXNlclBsYXllciIsImN1cnJlbnRQbGF5ZXIiLCJjaGVja0xvc3MiLCJwbGF5ZXIiLCJldmVyeSIsImFsZXJ0IiwiaW5pdEdhbWUiLCJjb25zb2xlIiwibG9nIiwidXNlckJvYXJkIiwicGxheVJvdW5kIiwic3dpdGNoVHVybiIsIm1vdmVFdmVudCIsImNlbGxCb2FyZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhZGRFdmVudExpc3RlbmVyIl0sInNvdXJjZVJvb3QiOiIifQ==