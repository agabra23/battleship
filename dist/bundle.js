(()=>{"use strict";const t=function(t){let e=0;const r=()=>{let e=0;return t.forEach((t=>{e++})),e};return{getLength:r,isSunk:()=>e>=r(),hit:()=>{e++},getHits:()=>e,getPath:()=>t,resetHits:()=>{e=0},hits:e}},e=e=>{const r=[],a=function(e){const r=[...Array(10)].map((t=>Array(10).fill("none"))),a=[],o=[];let n=[];const s=t=>{t.getPath().forEach((e=>{const[a,o]=e;r[a][o]=t})),c(t)},c=t=>{n.push(t)};return{placeShip:s,boardArray:r,receiveAttack:t=>{const[e,n]=t;let s,c=!1;s=a.some((e=>{const[r,a]=e;return r===t[0]&&a===t[1]})),c=o.some((e=>{const[r,a]=e;return r===t[0]&&a===t[1]})),"none"!==r[e][n]&&!1===s?(r[e][n].hit(),a.push(t)):"none"===r[e][n]&&!1===c&&o.push(t)},hits:a,misses:o,addShip:c,resetGameboard:()=>{a=[],o=[],n=[]},initBoard:()=>{s(t([[1,4],[1,5]])),s(t([[6,4],[6,5],[6,6]])),s(t([[4,2],[5,2],[6,2],[7,2]])),s(t([[8,3],[8,4],[8,5],[8,6],[8,7]])),s(t([[2,3],[2,4],[2,5],[2,6],[2,7]]))},isShip:t=>{const[e,a]=t;return"none"!==r[e][a]},getShip:t=>{const[e,a]=t;return r[e][a]},ships:n}}(),o=t=>{r.push(t)};return"computer"===e?{attempt:o,generateMove:()=>{const t=t=>Math.floor(Math.random()*t),e=t=>r.some((e=>{const[r,a]=e;return r===t[0]&&a===t[1]}));let a=[t(9),t(9)];for(;e(a);)a=[t(9),t(9)];return a},board:a}:{attempt:o,board:a}},r=t=>{const e=document.getElementById("board");t.boardArray.forEach(((r,a)=>{const o=document.createElement("div");o.classList.add("rowDiv"),r.forEach(((e,r)=>{const n=document.createElement("div");n.classList.add("boardCell"),n.id=`${a},${r}`,n.dataset.board=t.type,n.dataset.x=a,n.dataset.y=r,"none"!==e&&n.classList.add("shipCell"),o.appendChild(n)})),e.appendChild(o)}))},a=(t,e)=>{const[r,a]=t,o=document.getElementById(`${r},${a}`),n=e.isShip(t);o.innerHTML=n?"Hit":"Miss"},o=(()=>{const t=e("computer"),r=e("user");let n=r;return{initGame:()=>{console.log("init");const e=r.board;t.board.initBoard(),e.initBoard()},playRound:(e,o)=>{e===r&&(t.board.receiveAttack([2,3]),a([2,3],t.board))},switchTurn:()=>{n=n===r?t:r},computerPlayer:t,userPlayer:r,currentPlayer:n,checkLoss:t=>{t.board.ships.every((t=>t.isSunk()))&&alert("win")},moveEvent:t=>{const e="computer"===t.dataset.board?o.computerPlayer.board:o.userPlayer.board;o.computerPlayer.board.receiveAttack([t.dataset.x,t.dataset.y]),a([t.dataset.x,t.dataset.y],e)}}})(),n=o;n.initGame(),r(n.computerPlayer.board),n.playRound(n.currentPlayer),document.querySelectorAll(".boardCell").forEach((t=>{t.addEventListener("click",(()=>{n.moveEvent(t),n.checkLoss(n.computerPlayer)}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNMRSxTQTNDZSxLQUNmQyxRQUFRQyxJQUFJLFFBRVosTUFBTUMsRUFBWUwsRUFBV3hELE1BQ1B1RCxFQUFldkQsTUFDdkJ3QixZQUNkcUMsRUFBVXJDLFdBQVcsRUFzQ3JCc0MsVUFuQ2dCLENBQUNDLEVBQVFyRCxLQUNyQnFELElBQVdQLElBQ2JELEVBQWV2RCxNQUFNZ0IsY0FBYyxDQUFDLEVBQUcsSUFDdkMsRUFBVyxDQUFDLEVBQUcsR0FBSXVDLEVBQWV2RCxPQUNwQyxFQWdDQWdFLFdBN0JpQixLQUVmUCxFQURFQSxJQUFrQkQsRUFDSkQsRUFFQUMsQ0FDbEIsRUF5QkFELGlCQUNBQyxhQUNBQyxnQkFDQVEsVUF6QmlCRixJQUNEQSxFQUFPL0QsTUFBTU8sTUFBTTJELE9BQU9wRCxHQUNqQ0EsRUFBS3JCLFlBR0QwRSxNQUFNLE1BQU0sRUFxQnpCQyxVQWxCaUJyQixJQUNqQixNQUFNc0IsRUFDbUIsYUFBdkJ0QixFQUFLRSxRQUFRakQsTUFDVHNELEVBQUtDLGVBQWV2RCxNQUNwQnNELEVBQUtFLFdBQVd4RCxNQUV0QnNELEVBQUtDLGVBQWV2RCxNQUFNZ0IsY0FBYyxDQUFDK0IsRUFBS0UsUUFBUXRDLEVBQUdvQyxFQUFLRSxRQUFRckMsSUFDdEUsRUFBVyxDQUFDbUMsRUFBS0UsUUFBUXRDLEVBQUdvQyxFQUFLRSxRQUFRckMsR0FBSXlELEVBQVUsRUFhMUQsRUExRFksR0E0RGIsSUM1REEsRUFBS1gsV0FDTCxFQUFlLEVBQUtILGVBQWV2RCxPQUVuQyxFQUFLOEQsVUFBVSxFQUFLTCxlQUVIbkIsU0FBU2dDLGlCQUFpQixjQUNsQy9FLFNBQVN3RCxJQUNoQkEsRUFBS3dCLGlCQUFpQixTQUFTLEtBQzdCLEVBQUtILFVBQVVyQixHQUVmLEVBQUtrQixVQUFVLEVBQUtWLGVBQWUsR0FDbkMsRyIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9TaGlwLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9QbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL0dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvVUkuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL2dhbWUuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTaGlwID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgbGV0IGhpdHMgPSAwO1xuXG4gIGNvbnN0IGdldEhpdHMgPSAoKSA9PiB7XG4gICAgcmV0dXJuIGhpdHM7XG4gIH07XG5cbiAgY29uc3QgaGl0ID0gKCkgPT4ge1xuICAgIGhpdHMrKztcbiAgfTtcblxuICBjb25zdCBnZXRMZW5ndGggPSAoKSA9PiB7XG4gICAgbGV0IGNvdW50ID0gMDtcbiAgICBwYXRoLmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgIGNvdW50Kys7XG4gICAgfSk7XG4gICAgcmV0dXJuIGNvdW50O1xuICB9O1xuXG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IHtcbiAgICByZXR1cm4gaGl0cyA+PSBnZXRMZW5ndGgoKTtcbiAgfTtcblxuICBjb25zdCBnZXRQYXRoID0gKCkgPT4ge1xuICAgIHJldHVybiBwYXRoO1xuICB9O1xuXG4gIGNvbnN0IHJlc2V0SGl0cyA9ICgpID0+IHtcbiAgICBoaXRzID0gMDtcbiAgfTtcblxuICByZXR1cm4geyBnZXRMZW5ndGgsIGlzU3VuaywgaGl0LCBnZXRIaXRzLCBnZXRQYXRoLCByZXNldEhpdHMsIGhpdHMgfTtcbn07XG5leHBvcnQgZGVmYXVsdCBTaGlwO1xuIiwiaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9HYW1lYm9hcmRcIjtcblxuY29uc3QgUGxheWVyID0gKHR5cGUpID0+IHtcbiAgY29uc3QgYXR0ZW1wdHMgPSBbXTtcbiAgY29uc3QgdHVybiA9IGZhbHNlO1xuICBjb25zdCBib2FyZCA9IEdhbWVib2FyZCh0eXBlKTtcblxuICBjb25zdCBhdHRlbXB0ID0gKGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgYXR0ZW1wdHMucHVzaChjb29yZGluYXRlcyk7XG4gIH07XG5cbiAgY29uc3QgZ2VuZXJhdGVNb3ZlID0gKCkgPT4ge1xuICAgIGNvbnN0IGdldFJhbmRvbUludCA9IChtYXgpID0+IHtcbiAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBtYXgpO1xuICAgIH07XG5cbiAgICBjb25zdCBjaGVja0F0dGVtcHRlZCA9IChhdHRlbXB0KSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhdHRlbXB0cy5zb21lKChjb29yZGluYXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IFt4LCB5XSA9IGNvb3JkaW5hdGU7XG5cbiAgICAgICAgcmV0dXJuIHggPT09IGF0dGVtcHRbMF0gJiYgeSA9PT0gYXR0ZW1wdFsxXTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICBsZXQgbW92ZSA9IFtnZXRSYW5kb21JbnQoOSksIGdldFJhbmRvbUludCg5KV07XG5cbiAgICB3aGlsZSAoY2hlY2tBdHRlbXB0ZWQobW92ZSkpIHtcbiAgICAgIG1vdmUgPSBbZ2V0UmFuZG9tSW50KDkpLCBnZXRSYW5kb21JbnQoOSldO1xuICAgIH1cblxuICAgIHJldHVybiBtb3ZlO1xuICB9O1xuXG4gIGlmICh0eXBlID09PSBcImNvbXB1dGVyXCIpIHJldHVybiB7IGF0dGVtcHQsIGdlbmVyYXRlTW92ZSwgYm9hcmQgfTtcblxuICByZXR1cm4geyBhdHRlbXB0LCBib2FyZCB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgUGxheWVyO1xuIiwiaW1wb3J0IFNoaXAgZnJvbSBcIi4vU2hpcC5qc1wiO1xuXG5jb25zdCBHYW1lYm9hcmQgPSBmdW5jdGlvbiAodHlwZSkge1xuICBjb25zdCBib2FyZEFycmF5ID0gWy4uLkFycmF5KDEwKV0ubWFwKChlKSA9PiBBcnJheSgxMCkuZmlsbChcIm5vbmVcIikpO1xuICBjb25zdCBoaXRzID0gW107XG4gIGNvbnN0IG1pc3NlcyA9IFtdO1xuICBsZXQgc2hpcHMgPSBbXTtcblxuICBjb25zdCBpbml0Qm9hcmQgPSAoKSA9PiB7XG4gICAgcGxhY2VTaGlwKFxuICAgICAgU2hpcChbXG4gICAgICAgIFsxLCA0XSxcbiAgICAgICAgWzEsIDVdLFxuICAgICAgXSlcbiAgICApO1xuICAgIHBsYWNlU2hpcChcbiAgICAgIFNoaXAoW1xuICAgICAgICBbNiwgNF0sXG4gICAgICAgIFs2LCA1XSxcbiAgICAgICAgWzYsIDZdLFxuICAgICAgXSlcbiAgICApO1xuICAgIHBsYWNlU2hpcChcbiAgICAgIFNoaXAoW1xuICAgICAgICBbNCwgMl0sXG4gICAgICAgIFs1LCAyXSxcbiAgICAgICAgWzYsIDJdLFxuICAgICAgICBbNywgMl0sXG4gICAgICBdKVxuICAgICk7XG5cbiAgICBwbGFjZVNoaXAoXG4gICAgICBTaGlwKFtcbiAgICAgICAgWzgsIDNdLFxuICAgICAgICBbOCwgNF0sXG4gICAgICAgIFs4LCA1XSxcbiAgICAgICAgWzgsIDZdLFxuICAgICAgICBbOCwgN10sXG4gICAgICBdKVxuICAgICk7XG4gICAgcGxhY2VTaGlwKFxuICAgICAgU2hpcChbXG4gICAgICAgIFsyLCAzXSxcbiAgICAgICAgWzIsIDRdLFxuICAgICAgICBbMiwgNV0sXG4gICAgICAgIFsyLCA2XSxcbiAgICAgICAgWzIsIDddLFxuICAgICAgXSlcbiAgICApO1xuICB9O1xuXG4gIGNvbnN0IHJlc2V0R2FtZWJvYXJkID0gKCkgPT4ge1xuICAgIGhpdHMgPSBbXTtcbiAgICBtaXNzZXMgPSBbXTtcbiAgICBzaGlwcyA9IFtdO1xuICB9O1xuXG4gIGNvbnN0IHBsYWNlU2hpcCA9IChzaGlwT2JqZWN0KSA9PiB7XG4gICAgY29uc3QgcGF0aCA9IHNoaXBPYmplY3QuZ2V0UGF0aCgpO1xuICAgIHBhdGguZm9yRWFjaCgoY29vcmRpbmF0ZXMpID0+IHtcbiAgICAgIGNvbnN0IFt4LCB5XSA9IGNvb3JkaW5hdGVzO1xuICAgICAgYm9hcmRBcnJheVt4XVt5XSA9IHNoaXBPYmplY3Q7XG4gICAgfSk7XG4gICAgYWRkU2hpcChzaGlwT2JqZWN0KTtcbiAgfTtcblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gKGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgY29uc3QgW3gsIHldID0gY29vcmRpbmF0ZXM7XG5cbiAgICBsZXQgYWxyZWFkeUhpdCxcbiAgICAgIGFscmVhZHlNaXNzID0gZmFsc2U7XG5cbiAgICBhbHJlYWR5SGl0ID0gaGl0cy5zb21lKChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBbeEl0ZW0sIHlJdGVtXSA9IGl0ZW07XG4gICAgICByZXR1cm4geEl0ZW0gPT09IGNvb3JkaW5hdGVzWzBdICYmIHlJdGVtID09PSBjb29yZGluYXRlc1sxXTtcbiAgICB9KTtcbiAgICBhbHJlYWR5TWlzcyA9IG1pc3Nlcy5zb21lKChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBbeEl0ZW0sIHlJdGVtXSA9IGl0ZW07XG4gICAgICByZXR1cm4geEl0ZW0gPT09IGNvb3JkaW5hdGVzWzBdICYmIHlJdGVtID09PSBjb29yZGluYXRlc1sxXTtcbiAgICB9KTtcblxuICAgIGlmIChib2FyZEFycmF5W3hdW3ldICE9PSBcIm5vbmVcIiAmJiBhbHJlYWR5SGl0ID09PSBmYWxzZSkge1xuICAgICAgYm9hcmRBcnJheVt4XVt5XS5oaXQoKTtcbiAgICAgIGhpdHMucHVzaChjb29yZGluYXRlcyk7XG4gICAgfSBlbHNlIGlmIChib2FyZEFycmF5W3hdW3ldID09PSBcIm5vbmVcIiAmJiBhbHJlYWR5TWlzcyA9PT0gZmFsc2UpIHtcbiAgICAgIG1pc3Nlcy5wdXNoKGNvb3JkaW5hdGVzKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgYWRkU2hpcCA9IChzaGlwKSA9PiB7XG4gICAgc2hpcHMucHVzaChzaGlwKTtcbiAgfTtcblxuICBjb25zdCBpc1NoaXAgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICBjb25zdCBbeCwgeV0gPSBjb29yZGluYXRlcztcblxuICAgIHJldHVybiBib2FyZEFycmF5W3hdW3ldICE9PSBcIm5vbmVcIjtcbiAgfTtcblxuICBjb25zdCBnZXRTaGlwID0gKGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgY29uc3QgW3gsIHldID0gY29vcmRpbmF0ZXM7XG5cbiAgICByZXR1cm4gYm9hcmRBcnJheVt4XVt5XTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIHBsYWNlU2hpcCxcbiAgICBib2FyZEFycmF5LFxuICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgaGl0cyxcbiAgICBtaXNzZXMsXG4gICAgYWRkU2hpcCxcbiAgICByZXNldEdhbWVib2FyZCxcbiAgICBpbml0Qm9hcmQsXG4gICAgaXNTaGlwLFxuICAgIGdldFNoaXAsXG4gICAgc2hpcHMsXG4gIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBHYW1lYm9hcmQ7XG4iLCJpbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL0dhbWVib2FyZFwiO1xuaW1wb3J0IFBsYXllciBmcm9tIFwiLi9QbGF5ZXJcIjtcbmltcG9ydCBTaGlwIGZyb20gXCIuL1NoaXBcIjtcblxuY29uc3QgVUkgPSAoKCkgPT4ge1xuICBjb25zdCByZW5kZXJCb2FyZCA9IChwbGF5ZXJCb2FyZCkgPT4ge1xuICAgIGNvbnN0IGJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJib2FyZFwiKTtcblxuICAgIHBsYXllckJvYXJkLmJvYXJkQXJyYXkuZm9yRWFjaCgocm93LCByb3dJbmRleCkgPT4ge1xuICAgICAgY29uc3Qgcm93RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIHJvd0Rpdi5jbGFzc0xpc3QuYWRkKFwicm93RGl2XCIpO1xuXG4gICAgICByb3cuZm9yRWFjaCgoaXRlbSwgY2VsbEluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoXCJib2FyZENlbGxcIik7XG4gICAgICAgIGNlbGwuaWQgPSBgJHtyb3dJbmRleH0sJHtjZWxsSW5kZXh9YDtcbiAgICAgICAgY2VsbC5kYXRhc2V0LmJvYXJkID0gcGxheWVyQm9hcmQudHlwZTtcbiAgICAgICAgY2VsbC5kYXRhc2V0LnggPSByb3dJbmRleDtcbiAgICAgICAgY2VsbC5kYXRhc2V0LnkgPSBjZWxsSW5kZXg7XG4gICAgICAgIGlmIChpdGVtICE9PSBcIm5vbmVcIikgY2VsbC5jbGFzc0xpc3QuYWRkKFwic2hpcENlbGxcIik7XG5cbiAgICAgICAgcm93RGl2LmFwcGVuZENoaWxkKGNlbGwpO1xuICAgICAgfSk7XG5cbiAgICAgIGJvYXJkLmFwcGVuZENoaWxkKHJvd0Rpdik7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgYXR0ZW1wdCA9IChjb29yZGluYXRlcywgZ2FtZWJvYXJkKSA9PiB7XG4gICAgY29uc3QgW3gsIHldID0gY29vcmRpbmF0ZXM7XG4gICAgY29uc3QgdGFyZ2V0Q2VsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3h9LCR7eX1gKTtcbiAgICBjb25zdCBpc1NoaXAgPSBnYW1lYm9hcmQuaXNTaGlwKGNvb3JkaW5hdGVzKTtcblxuICAgIGlmIChpc1NoaXApIHtcbiAgICAgIHRhcmdldENlbGwuaW5uZXJIVE1MID0gXCJIaXRcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFyZ2V0Q2VsbC5pbm5lckhUTUwgPSBcIk1pc3NcIjtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHsgcmVuZGVyQm9hcmQsIGF0dGVtcHQgfTtcbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IFVJO1xuIiwiaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9HYW1lYm9hcmRcIjtcbmltcG9ydCBTaGlwIGZyb20gXCIuL1NoaXBcIjtcbmltcG9ydCBQbGF5ZXIgZnJvbSBcIi4vUGxheWVyXCI7XG5pbXBvcnQgVUkgZnJvbSBcIi4vVUlcIjtcblxuY29uc3QgZ2FtZSA9ICgoKSA9PiB7XG4gIGNvbnN0IGNvbXB1dGVyUGxheWVyID0gUGxheWVyKFwiY29tcHV0ZXJcIik7XG4gIGNvbnN0IHVzZXJQbGF5ZXIgPSBQbGF5ZXIoXCJ1c2VyXCIpO1xuXG4gIGxldCBjdXJyZW50UGxheWVyID0gdXNlclBsYXllcjtcblxuICBjb25zdCBpbml0R2FtZSA9ICgpID0+IHtcbiAgICBjb25zb2xlLmxvZyhcImluaXRcIik7XG5cbiAgICBjb25zdCB1c2VyQm9hcmQgPSB1c2VyUGxheWVyLmJvYXJkO1xuICAgIGNvbnN0IGNvbXB1dGVyQm9hcmQgPSBjb21wdXRlclBsYXllci5ib2FyZDtcbiAgICBjb21wdXRlckJvYXJkLmluaXRCb2FyZCgpO1xuICAgIHVzZXJCb2FyZC5pbml0Qm9hcmQoKTtcbiAgfTtcblxuICBjb25zdCBwbGF5Um91bmQgPSAocGxheWVyLCBjb29yZGluYXRlcykgPT4ge1xuICAgIGlmIChwbGF5ZXIgPT09IHVzZXJQbGF5ZXIpIHtcbiAgICAgIGNvbXB1dGVyUGxheWVyLmJvYXJkLnJlY2VpdmVBdHRhY2soWzIsIDNdKTtcbiAgICAgIFVJLmF0dGVtcHQoWzIsIDNdLCBjb21wdXRlclBsYXllci5ib2FyZCk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHN3aXRjaFR1cm4gPSAoKSA9PiB7XG4gICAgaWYgKGN1cnJlbnRQbGF5ZXIgPT09IHVzZXJQbGF5ZXIpIHtcbiAgICAgIGN1cnJlbnRQbGF5ZXIgPSBjb21wdXRlclBsYXllcjtcbiAgICB9IGVsc2Uge1xuICAgICAgY3VycmVudFBsYXllciA9IHVzZXJQbGF5ZXI7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGNoZWNrTG9zcyA9IChwbGF5ZXIpID0+IHtcbiAgICBjb25zdCBhbGxTdW5rID0gcGxheWVyLmJvYXJkLnNoaXBzLmV2ZXJ5KChzaGlwKSA9PiB7XG4gICAgICByZXR1cm4gc2hpcC5pc1N1bmsoKTtcbiAgICB9KTtcblxuICAgIGlmIChhbGxTdW5rKSBhbGVydChcIndpblwiKTtcbiAgfTtcblxuICBjb25zdCBtb3ZlRXZlbnQgPSAoY2VsbCkgPT4ge1xuICAgIGNvbnN0IGNlbGxCb2FyZCA9XG4gICAgICBjZWxsLmRhdGFzZXQuYm9hcmQgPT09IFwiY29tcHV0ZXJcIlxuICAgICAgICA/IGdhbWUuY29tcHV0ZXJQbGF5ZXIuYm9hcmRcbiAgICAgICAgOiBnYW1lLnVzZXJQbGF5ZXIuYm9hcmQ7XG5cbiAgICBnYW1lLmNvbXB1dGVyUGxheWVyLmJvYXJkLnJlY2VpdmVBdHRhY2soW2NlbGwuZGF0YXNldC54LCBjZWxsLmRhdGFzZXQueV0pO1xuICAgIFVJLmF0dGVtcHQoW2NlbGwuZGF0YXNldC54LCBjZWxsLmRhdGFzZXQueV0sIGNlbGxCb2FyZCk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBpbml0R2FtZSxcbiAgICBwbGF5Um91bmQsXG4gICAgc3dpdGNoVHVybixcbiAgICBjb21wdXRlclBsYXllcixcbiAgICB1c2VyUGxheWVyLFxuICAgIGN1cnJlbnRQbGF5ZXIsXG4gICAgY2hlY2tMb3NzLFxuICAgIG1vdmVFdmVudCxcbiAgfTtcbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGdhbWU7XG4iLCJpbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL21vZHVsZXMvR2FtZWJvYXJkLmpzXCI7XG5pbXBvcnQgU2hpcCBmcm9tIFwiLi9tb2R1bGVzL1NoaXAuanNcIjtcbmltcG9ydCBnYW1lIGZyb20gXCIuL21vZHVsZXMvZ2FtZS5qc1wiO1xuaW1wb3J0IFVJIGZyb20gXCIuL21vZHVsZXMvVUkuanNcIjtcblxuZ2FtZS5pbml0R2FtZSgpO1xuVUkucmVuZGVyQm9hcmQoZ2FtZS5jb21wdXRlclBsYXllci5ib2FyZCk7XG5cbmdhbWUucGxheVJvdW5kKGdhbWUuY3VycmVudFBsYXllcik7XG5cbmNvbnN0IGFsbENlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5ib2FyZENlbGxcIik7XG5hbGxDZWxscy5mb3JFYWNoKChjZWxsKSA9PiB7XG4gIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBnYW1lLm1vdmVFdmVudChjZWxsKTtcblxuICAgIGdhbWUuY2hlY2tMb3NzKGdhbWUuY29tcHV0ZXJQbGF5ZXIpO1xuICB9KTtcbn0pO1xuIl0sIm5hbWVzIjpbInBhdGgiLCJoaXRzIiwiZ2V0TGVuZ3RoIiwiY291bnQiLCJmb3JFYWNoIiwiZWxlbWVudCIsImlzU3VuayIsImhpdCIsImdldEhpdHMiLCJnZXRQYXRoIiwicmVzZXRIaXRzIiwidHlwZSIsImF0dGVtcHRzIiwiYm9hcmQiLCJib2FyZEFycmF5IiwiQXJyYXkiLCJtYXAiLCJlIiwiZmlsbCIsIm1pc3NlcyIsInNoaXBzIiwicGxhY2VTaGlwIiwic2hpcE9iamVjdCIsImNvb3JkaW5hdGVzIiwieCIsInkiLCJhZGRTaGlwIiwic2hpcCIsInB1c2giLCJyZWNlaXZlQXR0YWNrIiwiYWxyZWFkeUhpdCIsImFscmVhZHlNaXNzIiwic29tZSIsIml0ZW0iLCJ4SXRlbSIsInlJdGVtIiwicmVzZXRHYW1lYm9hcmQiLCJpbml0Qm9hcmQiLCJpc1NoaXAiLCJnZXRTaGlwIiwiYXR0ZW1wdCIsImdlbmVyYXRlTW92ZSIsImdldFJhbmRvbUludCIsIm1heCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNoZWNrQXR0ZW1wdGVkIiwiY29vcmRpbmF0ZSIsIm1vdmUiLCJwbGF5ZXJCb2FyZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyb3ciLCJyb3dJbmRleCIsInJvd0RpdiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJjZWxsSW5kZXgiLCJjZWxsIiwiaWQiLCJkYXRhc2V0IiwiYXBwZW5kQ2hpbGQiLCJnYW1lYm9hcmQiLCJ0YXJnZXRDZWxsIiwiaW5uZXJIVE1MIiwiZ2FtZSIsImNvbXB1dGVyUGxheWVyIiwidXNlclBsYXllciIsImN1cnJlbnRQbGF5ZXIiLCJpbml0R2FtZSIsImNvbnNvbGUiLCJsb2ciLCJ1c2VyQm9hcmQiLCJwbGF5Um91bmQiLCJwbGF5ZXIiLCJzd2l0Y2hUdXJuIiwiY2hlY2tMb3NzIiwiZXZlcnkiLCJhbGVydCIsIm1vdmVFdmVudCIsImNlbGxCb2FyZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhZGRFdmVudExpc3RlbmVyIl0sInNvdXJjZVJvb3QiOiIifQ==