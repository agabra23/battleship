(()=>{"use strict";const e=function(e){let t=0;const r=()=>{let t=0;return e.forEach((e=>{t++})),t};return{getLength:r,isSunk:()=>t>=r(),hit:()=>{t++},getHits:()=>t,getPath:()=>e,resetHits:()=>{t=0},hits:t}},t=t=>{const r=[],n=function(t){const r=[...Array(10)].map((e=>Array(10).fill("none"))),n=[],o=[];let s=[];const a=e=>{e.getPath().forEach((t=>{const[n,o]=t;r[n][o]=e})),d(e)},d=e=>{s.push(e)};return{placeShip:a,boardArray:r,receiveAttack:e=>{const[t,s]=e;let a,d=!1;a=n.some((t=>{const[r,n]=t;return r===e[0]&&n===e[1]})),d=o.some((t=>{const[r,n]=t;return r===e[0]&&n===e[1]})),"none"!==r[t][s]&&!1===a?(r[t][s].hit(),n.push(e)):"none"===r[t][s]&&!1===d&&o.push(e)},hits:n,misses:o,addShip:d,resetGameboard:()=>{n=[],o=[],s=[]},initBoard:()=>{a(e([[1,4],[1,5]])),a(e([[6,4],[6,5],[6,6]])),a(e([[4,2],[5,2],[6,2],[7,2]])),a(e([[8,3],[8,4],[8,5],[8,6],[8,7]])),a(e([[2,3],[2,4],[2,5],[2,6],[2,7]]))},isShip:e=>{const[t,n]=e;return"none"!==r[t][n]},getShip:e=>{const[t,n]=e;return r[t][n]},ships:s,type:t}}(t),o=e=>{r.push(e)};return"computer"===t?{attempt:o,generateMove:()=>{const e=e=>Math.floor(Math.random()*e),t=e=>r.some((t=>{const[r,n]=t;return r===e[0]&&n===e[1]}));let n=[e(9),e(9)];for(;t(n);)n=[e(9),e(9)];return n},board:n,type:t}:{attempt:o,board:n,type:t}},r=(()=>{const e=(e,t)=>{const[r,n]=e,o=document.getElementById(`${t.type} - ${r},${n}`),s=t.isShip(e);o.innerHTML=s?"Hit":"Miss"},t=e=>{e.classList.toggle("active")};return{renderBoard:t=>{const r=document.getElementById("board");r.innerHTML='<div id="overlay"></div>';const n=document.createElement("h3");console.log(t),n.innerHTML=`${t.type}'s Turn`,r.appendChild(n),t.boardArray.forEach(((e,n)=>{const s=document.createElement("div");s.classList.add("rowDiv"),e.forEach(((e,r)=>{const a=document.createElement("div");a.classList.add("boardCell"),a.id=`${t.type} - ${n},${r}`,a.dataset.board=t.type,a.dataset.x=n,a.dataset.y=r,"none"!==e&&(a.classList.add("shipCell"),e.isSunk()&&(a.style.backgroundColor="red")),a.addEventListener("click",(e=>{e.stopPropagation(),""===a.textContent&&o.moveEvent(a)})),s.appendChild(a)})),r.appendChild(s)})),t.misses.forEach((r=>{e(r,t)})),t.hits.forEach((r=>{e(r,t)}))},attempt:e,stopClicks:()=>{document.getElementById("overlay").style.pointerEvents="all"},startClicks:()=>{document.getElementById("overlay").style.pointerEvents="none"},styleSunk:e=>{document.querySelectorAll(".rowDiv").forEach((t=>{document.querySelectorAll(".boardCell").forEach((t=>{const[r,n]=[t.dataset.x,t.dataset.y];"User"===e?o.userPlayer.board.isShip([r,n])&&o.userPlayer.board.getShip([r,n]).isSunk()&&(t.style.backgroundColor="red"):o.computerPlayer.board.isShip([r,n])&&o.computerPlayer.board.getShip([r,n]).isSunk()&&(t.style.backgroundColor="red")}))}))},renderStart:()=>{const e=document.getElementById("startScreen");e.style.display="flex";const r=document.createElement("button");r.id="startBtn",r.textContent="Start Game",e.appendChild(r),document.getElementById("board").style.display="none",document.getElementById("switchTurnBtn").style.display="none",(()=>{const e=document.getElementById("startScreen");for(let t=0;t<10;t++){const r=document.createElement("div");r.classList.add("rowDiv");for(let e=0;e<10;e++){const n=document.createElement("div");n.classList.add("boardCell"),r.appendChild(n),n.dataset.x=t,n.dataset.y=e}e.appendChild(r)}})(),r.onclick=()=>{t(e),document.getElementById("board").style.display="",document.getElementById("switchTurnBtn").style.display="",r.style.display="none"}}}})(),n=(()=>{const e=t("Computer"),o=t("User");let s=e;const a=e=>{e.board.ships.every((e=>e.isSunk()))&&alert("win")};return{initGame:()=>{const t=o.board;e.board.initBoard(),t.initBoard()},switchTurn:()=>{console.log("start switch",n.currentPlayer.type),n.currentPlayer===o?n.currentPlayer=e:n.currentPlayer=o,console.log("end switch",n.currentPlayer.type)},computerPlayer:e,userPlayer:o,currentPlayer:s,checkLoss:a,moveEvent:t=>{r.stopClicks();const d="Computer"===t.dataset.board?e.board:o.board;d.receiveAttack([t.dataset.x,t.dataset.y]),r.attempt([t.dataset.x,t.dataset.y],d),r.styleSunk(d.type),a(s),n.switchTurn()}}})(),o=n;o.initGame();const s=document.getElementById("switchTurnBtn");r.renderBoard(o.currentPlayer.board),r.renderStart(),s.onclick=()=>{r.startClicks(),r.renderBoard(o.currentPlayer.board)}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNqQ0EsRUFBS3JCLFlBR0Q4RixNQUFNLE1BQU0sRUFpQjNCLE1BQU8sQ0FDTEMsU0F6Q2UsS0FDZixNQUFNQyxFQUFZakIsRUFBV3hFLE1BQ1B5RSxFQUFlekUsTUFDdkJ3QixZQUNkaUUsRUFBVWpFLFdBQVcsRUFzQ3JCa0UsV0FuQ2lCLEtBQ2pCekMsUUFBUUMsSUFBSSxlQUFnQmdDLEVBQUtDLGNBQWNyRixNQUMzQ29GLEVBQUtDLGdCQUFrQlgsRUFDekJVLEVBQUtDLGNBQWdCVixFQUVyQlMsRUFBS0MsY0FBZ0JYLEVBR3ZCdkIsUUFBUUMsSUFBSSxhQUFjZ0MsRUFBS0MsY0FBY3JGLEtBQUssRUE0QmxEMkUsaUJBQ0FELGFBQ0FXLGdCQUNBQyxZQUNBbkIsVUFyQmlCUixJQUNqQixFQUFHUyxhQUNILE1BQU15QixFQUNtQixhQUF2QmxDLEVBQUtFLFFBQVEzRCxNQUNUeUUsRUFBZXpFLE1BQ2Z3RSxFQUFXeEUsTUFFakIyRixFQUFVM0UsY0FBYyxDQUFDeUMsRUFBS0UsUUFBUWhELEVBQUc4QyxFQUFLRSxRQUFRL0MsSUFDdEQsRUFBR2UsUUFBUSxDQUFDOEIsRUFBS0UsUUFBUWhELEVBQUc4QyxFQUFLRSxRQUFRL0MsR0FBSStFLEdBQzdDLEVBQUd0QixVQUFVc0IsRUFBVTdGLE1BQ3ZCc0YsRUFBVUQsR0FDVkQsRUFBS1EsWUFBWSxFQVlwQixFQXZEWSxHQXlEYixJQ3pEQSxFQUFLRixXQUNMLE1BQU1JLEVBQWdCckQsU0FBU0MsZUFBZSxpQkFDOUMsRUFBR0ssWUFBWSxFQUFLc0MsY0FBY25GLE9BQ2xDLEVBQUcwRSxjQUVIa0IsRUFBY1gsUUFBVSxLQUN0QixFQUFHYixjQUVILEVBQUd2QixZQUFZLEVBQUtzQyxjQUFjbkYsTUFBTSxDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL1NoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL1BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvR2FtZWJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9VSS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvZ2FtZS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFNoaXAgPSBmdW5jdGlvbiAocGF0aCkge1xuICBsZXQgaGl0cyA9IDA7XG5cbiAgY29uc3QgZ2V0SGl0cyA9ICgpID0+IHtcbiAgICByZXR1cm4gaGl0cztcbiAgfTtcblxuICBjb25zdCBoaXQgPSAoKSA9PiB7XG4gICAgaGl0cysrO1xuICB9O1xuXG4gIGNvbnN0IGdldExlbmd0aCA9ICgpID0+IHtcbiAgICBsZXQgY291bnQgPSAwO1xuICAgIHBhdGguZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgY291bnQrKztcbiAgICB9KTtcbiAgICByZXR1cm4gY291bnQ7XG4gIH07XG5cbiAgY29uc3QgaXNTdW5rID0gKCkgPT4ge1xuICAgIHJldHVybiBoaXRzID49IGdldExlbmd0aCgpO1xuICB9O1xuXG4gIGNvbnN0IGdldFBhdGggPSAoKSA9PiB7XG4gICAgcmV0dXJuIHBhdGg7XG4gIH07XG5cbiAgY29uc3QgcmVzZXRIaXRzID0gKCkgPT4ge1xuICAgIGhpdHMgPSAwO1xuICB9O1xuXG4gIHJldHVybiB7IGdldExlbmd0aCwgaXNTdW5rLCBoaXQsIGdldEhpdHMsIGdldFBhdGgsIHJlc2V0SGl0cywgaGl0cyB9O1xufTtcbmV4cG9ydCBkZWZhdWx0IFNoaXA7XG4iLCJpbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL0dhbWVib2FyZFwiO1xuXG5jb25zdCBQbGF5ZXIgPSAodHlwZSkgPT4ge1xuICBjb25zdCBhdHRlbXB0cyA9IFtdO1xuICBjb25zdCB0dXJuID0gZmFsc2U7XG4gIGNvbnN0IGJvYXJkID0gR2FtZWJvYXJkKHR5cGUpO1xuXG4gIGNvbnN0IGF0dGVtcHQgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICBhdHRlbXB0cy5wdXNoKGNvb3JkaW5hdGVzKTtcbiAgfTtcblxuICBjb25zdCBnZW5lcmF0ZU1vdmUgPSAoKSA9PiB7XG4gICAgY29uc3QgZ2V0UmFuZG9tSW50ID0gKG1heCkgPT4ge1xuICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG1heCk7XG4gICAgfTtcblxuICAgIGNvbnN0IGNoZWNrQXR0ZW1wdGVkID0gKGF0dGVtcHQpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF0dGVtcHRzLnNvbWUoKGNvb3JkaW5hdGUpID0+IHtcbiAgICAgICAgY29uc3QgW3gsIHldID0gY29vcmRpbmF0ZTtcblxuICAgICAgICByZXR1cm4geCA9PT0gYXR0ZW1wdFswXSAmJiB5ID09PSBhdHRlbXB0WzFdO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIGxldCBtb3ZlID0gW2dldFJhbmRvbUludCg5KSwgZ2V0UmFuZG9tSW50KDkpXTtcblxuICAgIHdoaWxlIChjaGVja0F0dGVtcHRlZChtb3ZlKSkge1xuICAgICAgbW92ZSA9IFtnZXRSYW5kb21JbnQoOSksIGdldFJhbmRvbUludCg5KV07XG4gICAgfVxuXG4gICAgcmV0dXJuIG1vdmU7XG4gIH07XG5cbiAgaWYgKHR5cGUgPT09IFwiY29tcHV0ZXJcIikgcmV0dXJuIHsgYXR0ZW1wdCwgZ2VuZXJhdGVNb3ZlLCBib2FyZCwgdHlwZSB9O1xuXG4gIHJldHVybiB7IGF0dGVtcHQsIGJvYXJkLCB0eXBlIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBQbGF5ZXI7XG4iLCJpbXBvcnQgU2hpcCBmcm9tIFwiLi9TaGlwLmpzXCI7XG5cbmNvbnN0IEdhbWVib2FyZCA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gIGNvbnN0IGJvYXJkQXJyYXkgPSBbLi4uQXJyYXkoMTApXS5tYXAoKGUpID0+IEFycmF5KDEwKS5maWxsKFwibm9uZVwiKSk7XG4gIGNvbnN0IGhpdHMgPSBbXTtcbiAgY29uc3QgbWlzc2VzID0gW107XG4gIGxldCBzaGlwcyA9IFtdO1xuXG4gIGNvbnN0IGluaXRCb2FyZCA9ICgpID0+IHtcbiAgICBwbGFjZVNoaXAoXG4gICAgICBTaGlwKFtcbiAgICAgICAgWzEsIDRdLFxuICAgICAgICBbMSwgNV0sXG4gICAgICBdKVxuICAgICk7XG4gICAgcGxhY2VTaGlwKFxuICAgICAgU2hpcChbXG4gICAgICAgIFs2LCA0XSxcbiAgICAgICAgWzYsIDVdLFxuICAgICAgICBbNiwgNl0sXG4gICAgICBdKVxuICAgICk7XG4gICAgcGxhY2VTaGlwKFxuICAgICAgU2hpcChbXG4gICAgICAgIFs0LCAyXSxcbiAgICAgICAgWzUsIDJdLFxuICAgICAgICBbNiwgMl0sXG4gICAgICAgIFs3LCAyXSxcbiAgICAgIF0pXG4gICAgKTtcblxuICAgIHBsYWNlU2hpcChcbiAgICAgIFNoaXAoW1xuICAgICAgICBbOCwgM10sXG4gICAgICAgIFs4LCA0XSxcbiAgICAgICAgWzgsIDVdLFxuICAgICAgICBbOCwgNl0sXG4gICAgICAgIFs4LCA3XSxcbiAgICAgIF0pXG4gICAgKTtcbiAgICBwbGFjZVNoaXAoXG4gICAgICBTaGlwKFtcbiAgICAgICAgWzIsIDNdLFxuICAgICAgICBbMiwgNF0sXG4gICAgICAgIFsyLCA1XSxcbiAgICAgICAgWzIsIDZdLFxuICAgICAgICBbMiwgN10sXG4gICAgICBdKVxuICAgICk7XG4gIH07XG5cbiAgY29uc3QgcmVzZXRHYW1lYm9hcmQgPSAoKSA9PiB7XG4gICAgaGl0cyA9IFtdO1xuICAgIG1pc3NlcyA9IFtdO1xuICAgIHNoaXBzID0gW107XG4gIH07XG5cbiAgY29uc3QgcGxhY2VTaGlwID0gKHNoaXBPYmplY3QpID0+IHtcbiAgICBjb25zdCBwYXRoID0gc2hpcE9iamVjdC5nZXRQYXRoKCk7XG4gICAgcGF0aC5mb3JFYWNoKChjb29yZGluYXRlcykgPT4ge1xuICAgICAgY29uc3QgW3gsIHldID0gY29vcmRpbmF0ZXM7XG4gICAgICBib2FyZEFycmF5W3hdW3ldID0gc2hpcE9iamVjdDtcbiAgICB9KTtcbiAgICBhZGRTaGlwKHNoaXBPYmplY3QpO1xuICB9O1xuXG4gIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICBjb25zdCBbeCwgeV0gPSBjb29yZGluYXRlcztcblxuICAgIGxldCBhbHJlYWR5SGl0LFxuICAgICAgYWxyZWFkeU1pc3MgPSBmYWxzZTtcblxuICAgIGFscmVhZHlIaXQgPSBoaXRzLnNvbWUoKGl0ZW0pID0+IHtcbiAgICAgIGNvbnN0IFt4SXRlbSwgeUl0ZW1dID0gaXRlbTtcbiAgICAgIHJldHVybiB4SXRlbSA9PT0gY29vcmRpbmF0ZXNbMF0gJiYgeUl0ZW0gPT09IGNvb3JkaW5hdGVzWzFdO1xuICAgIH0pO1xuICAgIGFscmVhZHlNaXNzID0gbWlzc2VzLnNvbWUoKGl0ZW0pID0+IHtcbiAgICAgIGNvbnN0IFt4SXRlbSwgeUl0ZW1dID0gaXRlbTtcbiAgICAgIHJldHVybiB4SXRlbSA9PT0gY29vcmRpbmF0ZXNbMF0gJiYgeUl0ZW0gPT09IGNvb3JkaW5hdGVzWzFdO1xuICAgIH0pO1xuXG4gICAgaWYgKGJvYXJkQXJyYXlbeF1beV0gIT09IFwibm9uZVwiICYmIGFscmVhZHlIaXQgPT09IGZhbHNlKSB7XG4gICAgICBib2FyZEFycmF5W3hdW3ldLmhpdCgpO1xuICAgICAgaGl0cy5wdXNoKGNvb3JkaW5hdGVzKTtcbiAgICB9IGVsc2UgaWYgKGJvYXJkQXJyYXlbeF1beV0gPT09IFwibm9uZVwiICYmIGFscmVhZHlNaXNzID09PSBmYWxzZSkge1xuICAgICAgbWlzc2VzLnB1c2goY29vcmRpbmF0ZXMpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBhZGRTaGlwID0gKHNoaXApID0+IHtcbiAgICBzaGlwcy5wdXNoKHNoaXApO1xuICB9O1xuXG4gIGNvbnN0IGlzU2hpcCA9IChjb29yZGluYXRlcykgPT4ge1xuICAgIGNvbnN0IFt4LCB5XSA9IGNvb3JkaW5hdGVzO1xuXG4gICAgcmV0dXJuIGJvYXJkQXJyYXlbeF1beV0gIT09IFwibm9uZVwiO1xuICB9O1xuXG4gIGNvbnN0IGdldFNoaXAgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICBjb25zdCBbeCwgeV0gPSBjb29yZGluYXRlcztcblxuICAgIHJldHVybiBib2FyZEFycmF5W3hdW3ldO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgcGxhY2VTaGlwLFxuICAgIGJvYXJkQXJyYXksXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBoaXRzLFxuICAgIG1pc3NlcyxcbiAgICBhZGRTaGlwLFxuICAgIHJlc2V0R2FtZWJvYXJkLFxuICAgIGluaXRCb2FyZCxcbiAgICBpc1NoaXAsXG4gICAgZ2V0U2hpcCxcbiAgICBzaGlwcyxcbiAgICB0eXBlLFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgR2FtZWJvYXJkO1xuIiwiaW1wb3J0IEdhbWVib2FyZCBmcm9tIFwiLi9HYW1lYm9hcmRcIjtcbmltcG9ydCBQbGF5ZXIgZnJvbSBcIi4vUGxheWVyXCI7XG5pbXBvcnQgU2hpcCBmcm9tIFwiLi9TaGlwXCI7XG5pbXBvcnQgZ2FtZSBmcm9tIFwiLi9nYW1lXCI7XG5cbmNvbnN0IFVJID0gKCgpID0+IHtcbiAgY29uc3QgcmVuZGVyU3RhcnQgPSAoKSA9PiB7XG4gICAgY29uc3Qgc3RhcnRTY3JlZW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN0YXJ0U2NyZWVuXCIpO1xuICAgIHN0YXJ0U2NyZWVuLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcblxuICAgIGNvbnN0IHN0YXJ0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICBzdGFydEJ1dHRvbi5pZCA9IFwic3RhcnRCdG5cIjtcbiAgICBzdGFydEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU3RhcnQgR2FtZVwiO1xuXG4gICAgc3RhcnRTY3JlZW4uYXBwZW5kQ2hpbGQoc3RhcnRCdXR0b24pO1xuXG4gICAgY29uc3QgYm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJvYXJkXCIpO1xuICAgIGJvYXJkLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgIGNvbnN0IG5leHRUdXJuQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzd2l0Y2hUdXJuQnRuXCIpO1xuICAgIG5leHRUdXJuQnRuLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgIGdlbmVyYXRlR3JpZCgpO1xuXG4gICAgc3RhcnRCdXR0b24ub25jbGljayA9ICgpID0+IHtcbiAgICAgIHN0YXJ0RXZlbnQoc3RhcnRTY3JlZW4pO1xuICAgICAgc3RhcnRCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgIH07XG4gIH07XG5cbiAgY29uc3Qgc3RhcnRFdmVudCA9IChlbGVtZW50KSA9PiB7XG4gICAgdG9nZ2xlQWN0aXZlKGVsZW1lbnQpO1xuXG4gICAgY29uc3QgYm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJvYXJkXCIpO1xuICAgIGJvYXJkLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuXG4gICAgY29uc3QgbmV4dFR1cm5CdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInN3aXRjaFR1cm5CdG5cIik7XG4gICAgbmV4dFR1cm5CdG4uc3R5bGUuZGlzcGxheSA9IFwiXCI7XG4gIH07XG5cbiAgY29uc3QgcmVuZGVyQm9hcmQgPSAocGxheWVyQm9hcmQpID0+IHtcbiAgICBjb25zdCBib2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYm9hcmRcIik7XG4gICAgYm9hcmQuaW5uZXJIVE1MID0gYDxkaXYgaWQ9XCJvdmVybGF5XCI+PC9kaXY+YDtcblxuICAgIGNvbnN0IHBsYXllclRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgzXCIpO1xuICAgIGNvbnNvbGUubG9nKHBsYXllckJvYXJkKTtcbiAgICBwbGF5ZXJUaXRsZS5pbm5lckhUTUwgPSBgJHtwbGF5ZXJCb2FyZC50eXBlfSdzIFR1cm5gO1xuXG4gICAgYm9hcmQuYXBwZW5kQ2hpbGQocGxheWVyVGl0bGUpO1xuXG4gICAgcGxheWVyQm9hcmQuYm9hcmRBcnJheS5mb3JFYWNoKChyb3csIHJvd0luZGV4KSA9PiB7XG4gICAgICBjb25zdCByb3dEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgcm93RGl2LmNsYXNzTGlzdC5hZGQoXCJyb3dEaXZcIik7XG5cbiAgICAgIHJvdy5mb3JFYWNoKChpdGVtLCBjZWxsSW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChcImJvYXJkQ2VsbFwiKTtcbiAgICAgICAgY2VsbC5pZCA9IGAke3BsYXllckJvYXJkLnR5cGV9IC0gJHtyb3dJbmRleH0sJHtjZWxsSW5kZXh9YDtcbiAgICAgICAgY2VsbC5kYXRhc2V0LmJvYXJkID0gcGxheWVyQm9hcmQudHlwZTtcbiAgICAgICAgY2VsbC5kYXRhc2V0LnggPSByb3dJbmRleDtcbiAgICAgICAgY2VsbC5kYXRhc2V0LnkgPSBjZWxsSW5kZXg7XG4gICAgICAgIGlmIChpdGVtICE9PSBcIm5vbmVcIikge1xuICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChcInNoaXBDZWxsXCIpO1xuXG4gICAgICAgICAgaWYgKGl0ZW0uaXNTdW5rKCkpIHtcbiAgICAgICAgICAgIGNlbGwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZWRcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICAgIC8vIGFkanVzdCB0aGlzLiBNYXliZSBtYWtlIGl0IGEgcGxheVJvdW5kIHRoaW5nIHRvIGtpY2sgb2ZmIGEgcm91bmQgYW5kIGVuZCBpdCB3aXRoIGEgdHVybiBzd2l0Y2guXG4gICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICBpZiAoY2VsbC50ZXh0Q29udGVudCA9PT0gXCJcIikgZ2FtZS5tb3ZlRXZlbnQoY2VsbCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJvd0Rpdi5hcHBlbmRDaGlsZChjZWxsKTtcbiAgICAgIH0pO1xuXG4gICAgICBib2FyZC5hcHBlbmRDaGlsZChyb3dEaXYpO1xuICAgIH0pO1xuXG4gICAgcGxheWVyQm9hcmQubWlzc2VzLmZvckVhY2goKGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgICBhdHRlbXB0KGNvb3JkaW5hdGVzLCBwbGF5ZXJCb2FyZCk7XG4gICAgfSk7XG4gICAgcGxheWVyQm9hcmQuaGl0cy5mb3JFYWNoKChjb29yZGluYXRlcykgPT4ge1xuICAgICAgYXR0ZW1wdChjb29yZGluYXRlcywgcGxheWVyQm9hcmQpO1xuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IGF0dGVtcHQgPSAoY29vcmRpbmF0ZXMsIGdhbWVib2FyZCkgPT4ge1xuICAgIGNvbnN0IFt4LCB5XSA9IGNvb3JkaW5hdGVzO1xuICAgIGNvbnN0IHRhcmdldENlbGwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtnYW1lYm9hcmQudHlwZX0gLSAke3h9LCR7eX1gKTtcbiAgICBjb25zdCBpc1NoaXAgPSBnYW1lYm9hcmQuaXNTaGlwKGNvb3JkaW5hdGVzKTtcblxuICAgIGlmIChpc1NoaXApIHtcbiAgICAgIHRhcmdldENlbGwuaW5uZXJIVE1MID0gXCJIaXRcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFyZ2V0Q2VsbC5pbm5lckhUTUwgPSBcIk1pc3NcIjtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgc3RvcENsaWNrcyA9ICgpID0+IHtcbiAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvdmVybGF5XCIpO1xuXG4gICAgb3ZlcmxheS5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJhbGxcIjtcbiAgfTtcblxuICBjb25zdCBzdGFydENsaWNrcyA9ICgpID0+IHtcbiAgICBjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvdmVybGF5XCIpO1xuXG4gICAgb3ZlcmxheS5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG4gIH07XG5cbiAgY29uc3Qgc3R5bGVTdW5rID0gKGJvYXJkVHlwZSkgPT4ge1xuICAgIGNvbnN0IHJvd3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnJvd0RpdlwiKTtcbiAgICByb3dzLmZvckVhY2goKHJvdykgPT4ge1xuICAgICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJvYXJkQ2VsbFwiKTtcbiAgICAgIGNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgICAgY29uc3QgW3gsIHldID0gW2NlbGwuZGF0YXNldC54LCBjZWxsLmRhdGFzZXQueV07XG5cbiAgICAgICAgaWYgKGJvYXJkVHlwZSA9PT0gXCJVc2VyXCIpIHtcbiAgICAgICAgICBpZiAoZ2FtZS51c2VyUGxheWVyLmJvYXJkLmlzU2hpcChbeCwgeV0pKSB7XG4gICAgICAgICAgICBjb25zdCBzaGlwID0gZ2FtZS51c2VyUGxheWVyLmJvYXJkLmdldFNoaXAoW3gsIHldKTtcbiAgICAgICAgICAgIGlmIChzaGlwLmlzU3VuaygpKSBjZWxsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChnYW1lLmNvbXB1dGVyUGxheWVyLmJvYXJkLmlzU2hpcChbeCwgeV0pKSB7XG4gICAgICAgICAgICBjb25zdCBzaGlwID0gZ2FtZS5jb21wdXRlclBsYXllci5ib2FyZC5nZXRTaGlwKFt4LCB5XSk7XG4gICAgICAgICAgICBpZiAoc2hpcC5pc1N1bmsoKSkgY2VsbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJlZFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3QgdG9nZ2xlQWN0aXZlID0gKGVsZW1lbnQpID0+IHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoXCJhY3RpdmVcIik7XG4gIH07XG5cbiAgLy8gQ2hvb3NlIFNoaXAgTG9jYXRpb25zXG5cbiAgY29uc3QgZ2VuZXJhdGVHcmlkID0gKCkgPT4ge1xuICAgIGNvbnN0IHN0YXJ0U2NyZWVuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGFydFNjcmVlblwiKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgY29uc3Qgcm93RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIHJvd0Rpdi5jbGFzc0xpc3QuYWRkKFwicm93RGl2XCIpO1xuXG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChcImJvYXJkQ2VsbFwiKTtcbiAgICAgICAgcm93RGl2LmFwcGVuZENoaWxkKGNlbGwpO1xuXG4gICAgICAgIGNlbGwuZGF0YXNldC54ID0gaTtcbiAgICAgICAgY2VsbC5kYXRhc2V0LnkgPSBqO1xuICAgICAgfVxuXG4gICAgICBzdGFydFNjcmVlbi5hcHBlbmRDaGlsZChyb3dEaXYpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4ge1xuICAgIHJlbmRlckJvYXJkLFxuICAgIGF0dGVtcHQsXG4gICAgc3RvcENsaWNrcyxcbiAgICBzdGFydENsaWNrcyxcbiAgICBzdHlsZVN1bmssXG4gICAgcmVuZGVyU3RhcnQsXG4gIH07XG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBVSTtcbiIsImltcG9ydCBHYW1lYm9hcmQgZnJvbSBcIi4vR2FtZWJvYXJkXCI7XG5pbXBvcnQgU2hpcCBmcm9tIFwiLi9TaGlwXCI7XG5pbXBvcnQgUGxheWVyIGZyb20gXCIuL1BsYXllclwiO1xuaW1wb3J0IFVJIGZyb20gXCIuL1VJXCI7XG5cbmNvbnN0IGdhbWUgPSAoKCkgPT4ge1xuICBjb25zdCBjb21wdXRlclBsYXllciA9IFBsYXllcihcIkNvbXB1dGVyXCIpO1xuICBjb25zdCB1c2VyUGxheWVyID0gUGxheWVyKFwiVXNlclwiKTtcblxuICBsZXQgY3VycmVudFBsYXllciA9IGNvbXB1dGVyUGxheWVyO1xuXG4gIGNvbnN0IGluaXRHYW1lID0gKCkgPT4ge1xuICAgIGNvbnN0IHVzZXJCb2FyZCA9IHVzZXJQbGF5ZXIuYm9hcmQ7XG4gICAgY29uc3QgY29tcHV0ZXJCb2FyZCA9IGNvbXB1dGVyUGxheWVyLmJvYXJkO1xuICAgIGNvbXB1dGVyQm9hcmQuaW5pdEJvYXJkKCk7XG4gICAgdXNlckJvYXJkLmluaXRCb2FyZCgpO1xuICB9O1xuXG4gIGNvbnN0IHN3aXRjaFR1cm4gPSAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJzdGFydCBzd2l0Y2hcIiwgZ2FtZS5jdXJyZW50UGxheWVyLnR5cGUpO1xuICAgIGlmIChnYW1lLmN1cnJlbnRQbGF5ZXIgPT09IHVzZXJQbGF5ZXIpIHtcbiAgICAgIGdhbWUuY3VycmVudFBsYXllciA9IGNvbXB1dGVyUGxheWVyO1xuICAgIH0gZWxzZSB7XG4gICAgICBnYW1lLmN1cnJlbnRQbGF5ZXIgPSB1c2VyUGxheWVyO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKFwiZW5kIHN3aXRjaFwiLCBnYW1lLmN1cnJlbnRQbGF5ZXIudHlwZSk7XG4gIH07XG5cbiAgY29uc3QgY2hlY2tMb3NzID0gKHBsYXllcikgPT4ge1xuICAgIGNvbnN0IGFsbFN1bmsgPSBwbGF5ZXIuYm9hcmQuc2hpcHMuZXZlcnkoKHNoaXApID0+IHtcbiAgICAgIHJldHVybiBzaGlwLmlzU3VuaygpO1xuICAgIH0pO1xuXG4gICAgaWYgKGFsbFN1bmspIGFsZXJ0KFwid2luXCIpO1xuICB9O1xuXG4gIGNvbnN0IG1vdmVFdmVudCA9IChjZWxsKSA9PiB7XG4gICAgVUkuc3RvcENsaWNrcygpO1xuICAgIGNvbnN0IGNlbGxCb2FyZCA9XG4gICAgICBjZWxsLmRhdGFzZXQuYm9hcmQgPT09IFwiQ29tcHV0ZXJcIlxuICAgICAgICA/IGNvbXB1dGVyUGxheWVyLmJvYXJkXG4gICAgICAgIDogdXNlclBsYXllci5ib2FyZDtcblxuICAgIGNlbGxCb2FyZC5yZWNlaXZlQXR0YWNrKFtjZWxsLmRhdGFzZXQueCwgY2VsbC5kYXRhc2V0LnldKTtcbiAgICBVSS5hdHRlbXB0KFtjZWxsLmRhdGFzZXQueCwgY2VsbC5kYXRhc2V0LnldLCBjZWxsQm9hcmQpO1xuICAgIFVJLnN0eWxlU3VuayhjZWxsQm9hcmQudHlwZSk7XG4gICAgY2hlY2tMb3NzKGN1cnJlbnRQbGF5ZXIpO1xuICAgIGdhbWUuc3dpdGNoVHVybigpO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaW5pdEdhbWUsXG4gICAgc3dpdGNoVHVybixcbiAgICBjb21wdXRlclBsYXllcixcbiAgICB1c2VyUGxheWVyLFxuICAgIGN1cnJlbnRQbGF5ZXIsXG4gICAgY2hlY2tMb3NzLFxuICAgIG1vdmVFdmVudCxcbiAgfTtcbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGdhbWU7XG4iLCJpbXBvcnQgR2FtZWJvYXJkIGZyb20gXCIuL21vZHVsZXMvR2FtZWJvYXJkLmpzXCI7XG5pbXBvcnQgU2hpcCBmcm9tIFwiLi9tb2R1bGVzL1NoaXAuanNcIjtcbmltcG9ydCBnYW1lIGZyb20gXCIuL21vZHVsZXMvZ2FtZS5qc1wiO1xuaW1wb3J0IFVJIGZyb20gXCIuL21vZHVsZXMvVUkuanNcIjtcblxuZ2FtZS5pbml0R2FtZSgpO1xuY29uc3Qgc3dpdGNoVHVybkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3dpdGNoVHVybkJ0blwiKTtcblVJLnJlbmRlckJvYXJkKGdhbWUuY3VycmVudFBsYXllci5ib2FyZCk7XG5VSS5yZW5kZXJTdGFydCgpO1xuXG5zd2l0Y2hUdXJuQnRuLm9uY2xpY2sgPSAoKSA9PiB7XG4gIFVJLnN0YXJ0Q2xpY2tzKCk7XG5cbiAgVUkucmVuZGVyQm9hcmQoZ2FtZS5jdXJyZW50UGxheWVyLmJvYXJkKTtcbn07XG4iXSwibmFtZXMiOlsicGF0aCIsImhpdHMiLCJnZXRMZW5ndGgiLCJjb3VudCIsImZvckVhY2giLCJlbGVtZW50IiwiaXNTdW5rIiwiaGl0IiwiZ2V0SGl0cyIsImdldFBhdGgiLCJyZXNldEhpdHMiLCJ0eXBlIiwiYXR0ZW1wdHMiLCJib2FyZCIsImJvYXJkQXJyYXkiLCJBcnJheSIsIm1hcCIsImUiLCJmaWxsIiwibWlzc2VzIiwic2hpcHMiLCJwbGFjZVNoaXAiLCJzaGlwT2JqZWN0IiwiY29vcmRpbmF0ZXMiLCJ4IiwieSIsImFkZFNoaXAiLCJzaGlwIiwicHVzaCIsInJlY2VpdmVBdHRhY2siLCJhbHJlYWR5SGl0IiwiYWxyZWFkeU1pc3MiLCJzb21lIiwiaXRlbSIsInhJdGVtIiwieUl0ZW0iLCJyZXNldEdhbWVib2FyZCIsImluaXRCb2FyZCIsImlzU2hpcCIsImdldFNoaXAiLCJhdHRlbXB0IiwiZ2VuZXJhdGVNb3ZlIiwiZ2V0UmFuZG9tSW50IiwibWF4IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiY2hlY2tBdHRlbXB0ZWQiLCJjb29yZGluYXRlIiwibW92ZSIsImdhbWVib2FyZCIsInRhcmdldENlbGwiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW5uZXJIVE1MIiwidG9nZ2xlQWN0aXZlIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwicmVuZGVyQm9hcmQiLCJwbGF5ZXJCb2FyZCIsInBsYXllclRpdGxlIiwiY3JlYXRlRWxlbWVudCIsImNvbnNvbGUiLCJsb2ciLCJhcHBlbmRDaGlsZCIsInJvdyIsInJvd0luZGV4Iiwicm93RGl2IiwiYWRkIiwiY2VsbEluZGV4IiwiY2VsbCIsImlkIiwiZGF0YXNldCIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0b3BQcm9wYWdhdGlvbiIsInRleHRDb250ZW50IiwibW92ZUV2ZW50Iiwic3RvcENsaWNrcyIsInBvaW50ZXJFdmVudHMiLCJzdGFydENsaWNrcyIsInN0eWxlU3VuayIsImJvYXJkVHlwZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ1c2VyUGxheWVyIiwiY29tcHV0ZXJQbGF5ZXIiLCJyZW5kZXJTdGFydCIsInN0YXJ0U2NyZWVuIiwiZGlzcGxheSIsInN0YXJ0QnV0dG9uIiwiaSIsImoiLCJnZW5lcmF0ZUdyaWQiLCJvbmNsaWNrIiwiZ2FtZSIsImN1cnJlbnRQbGF5ZXIiLCJjaGVja0xvc3MiLCJwbGF5ZXIiLCJldmVyeSIsImFsZXJ0IiwiaW5pdEdhbWUiLCJ1c2VyQm9hcmQiLCJzd2l0Y2hUdXJuIiwiY2VsbEJvYXJkIiwic3dpdGNoVHVybkJ0biJdLCJzb3VyY2VSb290IjoiIn0=